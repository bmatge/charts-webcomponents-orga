<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Organigramme — Widget Grist</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: 'Marianne', arial, sans-serif;
    }
    gouv-orgchart {
      width: 100%;
      height: 100%;
    }
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: #666;
      font-size: 0.875rem;
    }

    /* Settings toggle button */
    .settings-toggle {
      position: fixed;
      top: 0.5rem;
      right: 0.5rem;
      z-index: 1000;
      width: 2rem;
      height: 2rem;
      border: 1px solid #ddd;
      background: #fff;
      border-radius: 0.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: #161616;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      transition: background-color 0.2s;
    }
    .settings-toggle:hover { background: #f0f0f0; }

    /* Settings panel */
    .settings-panel {
      display: none;
      position: fixed;
      top: 0;
      right: 0;
      z-index: 999;
      width: 280px;
      max-width: 90vw;
      height: 100%;
      background: #fff;
      border-left: 1px solid #ddd;
      box-shadow: -2px 0 12px rgba(0,0,0,0.1);
      padding: 1rem;
      overflow-y: auto;
      font-size: 0.8125rem;
    }
    .settings-panel.open { display: block; }

    .settings-panel h3 {
      font-size: 0.9375rem;
      color: #000091;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #000091;
    }

    .settings-field {
      margin-bottom: 0.875rem;
    }
    .settings-field label {
      display: block;
      font-weight: 700;
      margin-bottom: 0.25rem;
      color: #161616;
    }
    .settings-field select,
    .settings-field input[type="text"],
    .settings-field input[type="number"] {
      width: 100%;
      padding: 0.375rem 0.5rem;
      border: 1px solid #ddd;
      border-radius: 0.25rem;
      font-family: inherit;
      font-size: 0.8125rem;
      color: #161616;
      background: #fff;
    }
    .settings-field select:focus,
    .settings-field input:focus {
      border-color: #000091;
      outline: none;
    }
    .settings-field .hint {
      font-size: 0.6875rem;
      color: #666;
      margin-top: 0.125rem;
    }
  </style>
</head>
<body>
  <div class="loading" id="loading">Chargement du widget organigramme...</div>

  <gouv-orgchart
    id="orgchart"
    style="display: none;"
    searchable
    collapsible
    zoom
    highlight-path
  ></gouv-orgchart>

  <!-- Settings toggle -->
  <button class="settings-toggle" id="settings-toggle" title="Paramètres d'affichage" aria-label="Paramètres d'affichage">⚙</button>

  <!-- Settings panel -->
  <div class="settings-panel" id="settings-panel">
    <h3>Paramètres</h3>

    <div class="settings-field">
      <label for="opt-titre">Titre</label>
      <input type="text" id="opt-titre" placeholder="Organigramme" />
      <div class="hint">Titre affiché au-dessus de l'organigramme</div>
    </div>

    <div class="settings-field">
      <label for="opt-node-style">Style des noeuds</label>
      <select id="opt-node-style">
        <option value="card">Carte (photo + badge + direction)</option>
        <option value="compact">Compact (nom + fonction)</option>
        <option value="detailed">Détaillé (avec email + téléphone)</option>
      </select>
    </div>

    <div class="settings-field">
      <label for="opt-orientation">Orientation</label>
      <select id="opt-orientation">
        <option value="top-to-bottom">Haut → Bas</option>
        <option value="left-to-right">Gauche → Droite</option>
      </select>
    </div>

    <div class="settings-field">
      <label for="opt-expand-level">Niveaux dépliés</label>
      <input type="number" id="opt-expand-level" value="2" min="0" max="10" />
      <div class="hint">0 = tout déplié</div>
    </div>

    <div class="settings-field">
      <label for="opt-searchable">Recherche</label>
      <select id="opt-searchable">
        <option value="true">Activée</option>
        <option value="false">Désactivée</option>
      </select>
    </div>

    <div class="settings-field">
      <label for="opt-compact">Mode compact</label>
      <select id="opt-compact">
        <option value="false">Non</option>
        <option value="true">Oui (espacement réduit)</option>
      </select>
      <div class="hint">Réduit l'espacement entre les noeuds</div>
    </div>
  </div>

  <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
  <script type="module" src="./plugin.js"></script>
</body>
</html>
